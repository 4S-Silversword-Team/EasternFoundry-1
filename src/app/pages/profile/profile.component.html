<div class="container" *ngIf='!this.promiseFinished'>
  <div class="loader"></div>
  <!-- <p class="loading">Loading</p> -->
</div>
<div class="page" *ngIf='this.promiseFinished && !this.isActiveProfile && !this.currentUser.finished'>
  <h3 style="text-align: center">This user has not finished their profile yet. Check back when they've completed it!</h3>
</div>
<div class="page" *ngIf='this.promiseFinished && this.currentUser.finished'>
  <div class="edit-box">
    <div *ngIf="this.isActiveProfile" class="btn-edit" (click) = 'editProfile()'>Edit</div>
  </div>
    <!-- <div class="container profile-top-bar">
    <div class="profile-navbar">
    <div class="profile-navbar-tab" (click)='switchTab(0)' [ngClass]="{'profile-navbar-tab-active-left': this.activeTab.main == 0}">
    Profile
  </div>
  <div class="profile-navbar-tab" (click)='switchTab(1)' [ngClass]="{'profile-navbar-tab-active': this.activeTab.main == 1}">
  Education
  </div>
  <div class="profile-navbar-tab" (click)='switchTab(2)' [ngClass]="{'profile-navbar-tab-active': this.activeTab.main == 2}">
  Career
  </div>
  <div class="profile-navbar-tab" (click)='switchTab(3)' [ngClass]="{'profile-navbar-tab-active': this.activeTab.main == 3}">
  Analytics
  </div>
  <div class="profile-navbar-tab tab-right pp-tab" (click)='switchTab(4)' style="overflow: hidden" [ngClass]="{'profile-navbar-tab-active-right': this.activeTab.main == 4}">
  Past Performances
  </div>
  <div class="profile-navbar-tab tab-right pp-tab-small" (click)='switchTab(4)' style="overflow: hidden" [ngClass]="{'profile-navbar-tab-active-right': this.activeTab.main == 4}">
  Past<br>Performances
  </div>
  </div>
  <div class="edit-box">
  <div *ngIf="this.isActiveProfile" class="btn-edit" (click) = 'editProfile()'>Edit</div>
  </div>
  </div> -->
  <div class="container">
    <div class="basic-info col-xs-12">
      <div class="" style="height: 150px; width: 180px; position: relative; float: left;">
        <div class="left avatar">
          <img src='{{ this.currentUser.avatar }}' class="avatar-img">
        </div>
      </div>
      <div class="basic-info-top">
        <div class="" style="width: 100%; height: 150px;">
          <div class="col-xs-12 basic-info-header">
            <p>{{this.currentUser.firstName}} {{this.currentUser.lastName}}</p>
          </div>
          <div class="col-xs-12 basic-info-sub" *ngIf='this.currentJob'>
            <p>{{this.currentJob.PositionTitle}}, {{this.currentJob.Employer}}</p>
          </div>
          <div class="col-xs-12 basic-info-sub-2" *ngIf='this.topClearance'>
            <p>{{this.topClearance}} Clearance</p>
          </div>
          <div class="col-xs-12 basic-info-sub audiowide">
            <a href="user-profile/{{this.currentUser._id}}/resume">See {{ this.currentUser.firstName }} {{this.currentUser.lastName}}'s Resume</a>
          </div>
        </div>
      </div>
      <div class="profile-top-bar">
        <div class="profile-navbar">
          <div class="profile-navbar-tab" (click)='switchTab(0)' [ngClass]="{'profile-navbar-tab-active': this.activeTab.main == 0}">
            Profile
          </div>
          <div class="profile-navbar-tab" (click)='switchTab(1)' [ngClass]="{'profile-navbar-tab-active': this.activeTab.main == 1}">
            Analytics
          </div>
          <div class="profile-navbar-tab" (click)='switchTab(2)' [ngClass]="{'profile-navbar-tab-active': this.activeTab.main == 2}">
            Career
          </div>
          <div class="profile-navbar-tab" (click)='switchTab(3)' [ngClass]="{'profile-navbar-tab-active': this.activeTab.main == 3}">
            Education
          </div>
          <div class="profile-navbar-tab pp-tab" (click)='switchTab(4)' style="overflow: hidden" [ngClass]="{'profile-navbar-tab-active': this.activeTab.main == 4}">
            Past Performances
          </div>
          <div class="profile-navbar-tab pp-tab-small" (click)='switchTab(4)' style="overflow: hidden" [ngClass]="{'profile-navbar-tab-active': this.activeTab.main == 4}">
            Past<br>Performances
          </div>
        </div>
      </div>
      <div class="" style="width: 100%; height: 8px; border-bottom: 1px solid rgba(0,0,0,0.4)">
      </div>
    </div>
  </div>
  <div class="" style="width: 100%; margin-top: 8px; height: calc(99vh - 254px);">
    <!-- PROFILE TAB -->
    <div class="container" *ngIf='this.activeTab.main == 0'>
      <div class="basic-info-bottom">
        <div id="user-contact" class="col-xs-5 scrollbar" style="overflow-y: auto; height: 100%; padding-top: .1v; padding-bottom: .1v; border-right: 2px solid rgba(0,0,0,0.25);">
          <div class="" style="width: 100%;">
            <p class="basic-info-text-2">{{ this.currentUser.address.city }}, {{ this.currentUser.address.state }}</p>
            <p class=" basic-info-text-2">{{ this.currentUser.phone[0].Number }}</p>
            <p class="basic-info-text-2">{{ this.currentUser.username }}</p>
          </div>
          <div style="width: 100%; margin-top: 20px;">
            <p class="basic-info-text-2">{{ this.currentUser.education[0].DegreeType[0].Name }}</p>
            <p class="basic-info-text-2">{{ this.currentUser.education[0].MajorProgramName[0] }}, {{ this.currentUser.education[0].School }}</p>
            <p class="basic-info-text-2">{{ this.currentUser.education[0].AttendanceEndDate.slice(0,4) }}</p>
          </div>
        </div>
        <div id="user-contact" class="col-xs-7 scrollbar" style="overflow-y: auto; padding-top: .1vh; height: 100%;">
          <div class="basic-info-career-panel" style="width: 100%; height: auto;" *ngFor='let p of this.currentUser.positionHistory'>
            <div class="basic-info-text-2">
              <div class="left">
                {{ p.Employer }}
              </div>
              <div class="right">
                {{p.StartDate.slice(0,4)}} - {{p.EndDate.slice(0,4)}}
              </div>
            </div><br>
            <p class="basic-info-text-2 left">{{ p.PositionTitle }}</p>
            <p class="basic-info-text-2 left" style="margin-bottom: 20px;">{{ p.Description.slice(0,50) }}...</p>
          </div>
            <!-- <div class="col-xs-12 basic-info-text" style="margin-top: 2px"><p class=" basic-info-text-2">{{ this.currentUser.phone[0].Number }}</p></div>
            <div class="col-xs-12 basic-info-text-2" style="margin-top: -10px">
            <rating [(ngModel)]="this.currentUser.informationAccuracy" [max]="5" style="margin-left: 25%"></rating>
            <p class="noWrapScroll" style="margin-top: -25px; font-size: 12px; text-align: center">Updated {{ this.currentUser.lastUpdated}}</p>
          </div> -->
        </div>
      </div>
      <div class="col-xs-12" style="background: rgba(223,223,225,1); height: calc(55vh - 127px); border-bottom: 0px solid black">
        <div class="col-xs-6" id="service_chart"  style="height: calc(55vh - 127px); margin: 0 auto" [chart]="serviceChart"></div>
        <div class="col-xs-6" id="category_chart"  style="height: calc(55vh - 127px); margin: 0 auto" [chart]="categoryChart"></div>
      </div>
    </div>

    <!-- SKILLS TAB -->
    <div class="container" *ngIf='this.activeTab.main == 1' style='height: 100%'>
      <div class="" style="height: 100%; width: 100%;">
        <div class="skill-tab-bar">
          <div class="skill-tab" (click)='this.activeTab.skill = 0' [ngClass]="{'skill-tab-active': this.activeTab.skill == 0}">
            Agency Experience
          </div>
          <div class="skill-tab" (click)='this.activeTab.skill = 1' [ngClass]="{'skill-tab-active': this.activeTab.skill == 1}">
            Career Capabilities
          </div>
          <div class="skill-tab" (click)='this.activeTab.skill = 2' [ngClass]="{'skill-tab-active': this.activeTab.skill == 2}">
            Skills
          </div>
          <div class="col-xs-12" style="width: 100%; height: 8px; border-bottom: 1px solid rgba(0,0,0,0.4);">
          </div>
        </div>
        <div class="skills col-xs-12" *ngIf='this.agencyExperience && this.activeTab.skill == 0'>
          <div class="" *ngIf='this.agencyExperience[0]' style="width: 100%; height: 100%">
            <div class="experience col-xs-12" *ngIf='this.agencyExperience[0].main.title'>
              <div id="team_chart" style="width: 100%; height: 100%; margin: 0 auto; background: none;" [chart]="agencyChart"></div>
            </div>
          </div>
        </div>
        <div class="skills col-xs-12" *ngIf='this.activeTab.skill == 1'>
          <div class="product-tab-bar" style="width: 100%;">
            <div class="product-tab col-xs-3" (click)='activeTab.service = activeTab.service-1' *ngIf='activeTab.service>0 && this.serviceChartNames[this.activeTab.service-1]'>
              <div class="skill-tab-text">{{this.serviceChartNames[this.activeTab.service-1]}}</div>
            </div>
            <div class="product-tab product-tab-active col-xs-6 col-xs-offset-3" *ngIf='activeTab.service<=0 && this.serviceChartNames[this.activeTab.service]'>
              <div class="skill-tab-text">{{this.serviceChartNames[this.activeTab.service]}}</div>
            </div>
            <div class="product-tab product-tab-active col-xs-6" *ngIf='activeTab.service>0 && this.serviceChartNames[this.activeTab.service]'>
              <div class="skill-tab-text">{{this.serviceChartNames[this.activeTab.service]}}</div>
            </div>
            <div class="product-tab col-xs-3" (click)='activeTab.service = activeTab.service+1' *ngIf='this.serviceChartNames[activeTab.service+1]'>
              <div class="skill-tab-text">{{this.serviceChartNames[this.activeTab.service+1]}}</div>
            </div>
          </div>
          <div class="services col-xs-12" *ngFor='let c of this.charts; let i = index'>
            <div id="team_chart" style="margin: 0 auto; height: calc(98vh - 258px); width: 100%;" [chart]='c' *ngIf='i==activeTab.service'></div>
          </div>
        </div>
        <div class="skills col-xs-12" *ngIf="this.activeTab.skill == 2">
          <div id="team_chart"  style="max-width: 85%; margin: 0 auto; height:100%" [chart]='this.skillChart'></div>
        </div>
      </div>
    </div>

    <!-- CAREER TAB -->
    <div class="container" *ngIf='this.activeTab.main == 2' style='height: 100%'>
      <div class="col-xs-12" *ngIf = 'this.promiseFinished' style="height: 100%; padding: 0px;">
        <career class="" [Data]="this.currentUser.positionHistory" [current]="currentYear()"></career>
      </div>
    </div>

    <!-- EDUCATION TAB -->
    <div class="container" style="height: 100%; position: relative;" *ngIf='this.activeTab.main == 3'>
      <div class="education-1 col-xs-12" [ngClass]="{'education-1-tall': this.currentUser.clearance.length == 0 && this.currentUser.award.length == 0}">
        <div class="education-left scrollbar" *ngIf = 'this.currentUser.education' [ngClass]="{'education-full': this.currentUser.certification.length == 0}">
          <div class="education-header">
            Degrees
          </div>
          <div class="" *ngFor="let deg of this.currentUser.education" class="degree-box">
            <div *ngIf="deg.DegreeType[0] && deg.DegreeType[0].Name.length > 0">
              <div *ngIf="deg.MajorProgramName && deg.MajorProgramName.length > 0">
                <div *ngIf="deg.School && deg.School.length > 0">
                  <div *ngIf="deg.AttendanceEndDate && deg.AttendanceEndDate.length > 0">
                    <p class="degree-text">
                      {{deg.School}}, {{deg.DegreeType[0].Name}} in {{deg.MajorProgramName[0]}}
                    </p>
                    <p class="degree-subtext">Graduated {{deg.AttendanceEndDate}}</p>
                    <textarea class="degree-subtext" autosize>{{deg.Comment}}</textarea>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="" *ngIf = 'this.currentUser.certification'>
          <div class="" *ngIf = 'this.currentUser.certification[0]'>
            <div class="education-right scrollbar" *ngIf = 'this.currentUser.certification[0].CertificationName.length > 0' [ngClass]="{'education-full': this.currentUser.education.length == 0}">
              <div class="education-header">
                Certifications
              </div>
              <div class="" *ngFor="let cert of this.currentUser.certification">
                <div class="" *ngIf="cert.CertificationName && cert.CertificationName.length > 0">
                  <div class="degree-box" *ngIf="cert.DateEarned && cert.DateEarned.length > 0">
                    <p class="degree-text">
                      {{cert.CertificationName}} Certification
                    </p>
                    <p class="degree-subtext">Earned {{cert.DateEarned}}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="education-2 col-xs-12" *ngIf="this.currentUser.clearance.length > 0 || this.currentUser.award.length > 0">
        <div class="education-left scrollbar" [ngClass]="{'education-full': this.currentUser.clearance.length == 0}">
          <div class="education-header" *ngIf='this.currentUser.award.length > 0'>
            Awards
          </div>
          <div class="" *ngFor="let award of this.currentUser.award" class="degree-box">
            <p class="degree-text" *ngIf="award.length > 0">{{award}} Award</p>
          </div>
        </div>
        <div class="" *ngIf='this.currentUser.clearance'>
          <div class="" *ngIf='this.currentUser.clearance[0]'>
            <div class="education-right scrollbar" *ngIf='this.currentUser.clearance[0].clearanceType.length > 0' [ngClass]="{'education-full': this.currentUser.award.length == 0}">
              <div class="education-header">
                Clearances
              </div>
              <div class="" *ngFor="let clearance of this.currentUser.clearance">
                <div class="" *ngIf="clearance.clearanceType.length > 0">
                  <div class="" *ngIf="clearance.awarded.length > 0">
                    <div class="degree-box" *ngIf="clearance.expiration.length > 0">
                      <p class="degree-text">
                        {{clearance.clearanceType}} Clearance
                      </p>
                      <p class="degree-subtext">Awarded {{clearance.awarded}}, expires {{clearance.expiration}}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- PAST PERFORMANCES TAB -->
    <div class="container" *ngIf='this.activeTab.main == 4'>
      <div class="past-performances col-xs-12 scrollbar">
        <div class="col-xs-12 past-performance-panel" *ngFor='let pp of pastPerformances'>
          <div class="" *ngIf="pp.public">
            <div class="" style="height: 180px; width: 180px; position: relative; float: left;">
              <div class="left avatar">
                <img src='{{ pp.avatar }}' class="avatar-img">
              </div>
            </div>
            <div class="past-performance-panel-inner">
              <!--<div id="user-contact" class="col-xs-12" style="height: 100%; padding-bottom: .1vh; border-right: 2px solid rgba(0,0,0,0.25);">-->
              <div id="user-contact" class="col-xs-12" style="height: 100%; padding-bottom: .1vh;">
                <div class="" style="width: 100%;">
                  <a href="past-performance/{{pp._id}}">
                    <p class="basic-info-header">{{ pp.title }}</p>
                  </a>
                  <p class="basic-info-sub">{{ pp.client.name }}</p>
                  <p class="basic-info-sub-2">{{ pp.topic }}</p>
                </div>
              </div>
              <!--<div id="user-contact" class="col-md-6 col-sm-0" style="overflow-y: auto; padding-top: .1vh; height: 100%;">-->
              <!--<p class="basic-info-text-2">{{ pp.startDate }} - {{ pp.endDate }}</p>-->
              <!--</div>-->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
