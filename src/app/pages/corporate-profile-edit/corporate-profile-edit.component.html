<div class="container" *ngIf='!this.promiseFinished'>
  <div class="loader"></div>
  <!-- <p class="loading">Loading</p> -->
</div>
<div class="basic-info col-xs-12 clear" *ngIf='this.promiseFinished'>
  <div class="container">
    <div class="col-xs-12 col-md-6">
      <div class="col-xs-12 srow info-input">
        <p class="left">Name</p>
        <input class="right" type="text" placeholder="Company name." [(ngModel)] = 'this.currentAccount.name'>
      </div>
      <div class="col-xs-12 mt10">
        <p class="left lh-50 mt10" [style.width]="'80px'">Logo</p>
        <img *ngIf="this.currentAccount.avatar" src="{{this.currentAccount.avatar}}" class="avatar left">
        <div *ngIf="!creatingNew && (!this.currentAccount.avatar || this.currentAccount.avatar.startsWith('..'))" class="right">
          <input type="file" #fileInput accept=".jpg,.png" style="width:100%"/>
          <button class="btn btn-primary" (click)="uploadPhoto()">Upload Logo</button>
        </div>
        <div *ngIf="this.currentAccount.avatar && !this.currentAccount.avatar.startsWith('..')" class="right">
          <input type="file" #fileInput accept=".jpg,.png" style="width:100%"/>
          <button class="btn btn-primary" (click)="editPhoto()">Edit Logo</button>
        </div>
      </div>
      <!--<div class="col-xs-12" [style.height]="'130px'">
          <p clvehicleType"left">Set-Aside</p>
          <div class="text-container right" [style.height]="'130pxvehicleTypestyle.width] = "infoInputWidth+'px'">
              <div class="col-xs-12" [style.overfvehicleType = "'auto'" [style.height]="'90px'">
                  <div class="ssrow"><input type="checkbox" class="left"><p >XXX</p></div>
                  <div class="ssrow"><input type="checkbox" class="left"><p >XXX</p></div>
                  <div class="ssrow"><input type="checkbox" class="left"><p >XXX</p></div>
              </div>
          </div>
      </div>-->
      <!--<div class="col-xs-12 srow">
          <p class="left">DCAA</p>
          <invehicleTypetype="checkbox">
      </div>-->
      <!--<div class="col-xs-12" [style.height]="'130px'">
          <p clvehicleType"left">FCL</p>
          <div class="text-container right" [style.height]="'130px'" [stvehicleTypewidth] = "infoInputWidth+'px'">
              <div class="col-xs-12" [style.overflow] =vehicleTypeuto'" [style.height]="'90px'">
                  <div class="ssrow"><input type="checkbox" class="left"><p >XXX</p></div>
                  <div class="ssrow"><input type="checkbox" class="left"><p >XXX</p></div>
                  <div class="ssrow"><input type="checkbox" class="left"><p >XXX</p></div>
              </div>
          </div>
      </div>-->
      <!--<div class="col-xs-12" [style.height]="'130px'">
          <p class="left">Schedules</p>
          <div class="text-container right" [style.height]="'130px'" [style.width] = "infoInputWidth+'px'">
          </div>
      </div>
      <div class="col-xs-12" [style.height]="'130px'">
          <p class="left">Major<br>Vehicles</p>
          <div class="text-container right" [style.height]="'130px'" [style.width] = "infoInputWidth+'px'">
          </div>
      </div>-->
    </div>
    <div class="col-xs-12 col-md-6">
      <div class="col-xs-12 srow info-img-input"><img src="../assets/img/glyphicon/email-1.png" class="left"><p class="left">Email</p><input type="text" [(ngModel)] = 'this.currentAccount.email'></div>
      <div class="col-xs-12 srow info-img-input mt10"><img src="../assets/img/glyphicon/phone-2.png" class="left"><p class="left" style="line-height: 25px;">Contact<br> Number</p><input type="text" [(ngModel)] = "this.currentAccount.contactNumber"></div>
      <div class="col-xs-12 srow info-img-input mt10"><img src="../assets/img/glyphicon/post-1.png" class="left"><p class="left">Address</p><input type="text"  [(ngModel)] = 'this.currentAccount.address'></div>
      <div class="col-xs-12 srow info-img-input mt10"><img src="../assets/img/glyphicon/post-1.png" class="left"><p class="left">City</p><input type="text"  [(ngModel)] = 'this.currentAccount.city'></div>
      <div class="col-xs-12 srow info-img-input mt10"><img src="../assets/img/profile/state.png" class="left"><p class="left">State</p><input type="text"  [(ngModel)] = 'this.currentAccount.state'></div>
      <div class="col-xs-12 srow info-img-input mt10"><img src="../assets/img/profile/zip.png" class="left"><p class="left">Zip</p><input type="text"  [(ngModel)] = 'this.currentAccount.zip'></div>
    </div>
    <div *ngIf="this.creatingNew || this.isUserAdmin" class="text-center" style="display: inline-block"><button class="btn btn-primary btn-block" (click)="updateCompany(this.currentAccount)">Update Company</button></div>
  </div>

<!-- TODO: This employee section is not responsive for phones. Need to deal with overlapping text. -->
<div class="employees col-xs-12 clear">
  <div class="div-title col-xs-12">
    <img src="./assets/img/employee.png">
    <p>EMPLOYEES</p>
    <div></div>
  </div>
  <div *ngIf="!creatingNew" class="container">
    <div class="col-xs-12">
      <table class="table">
        <tr>
        <th><span></span></th>
        <th><span>Name</span></th>
        <th><span>Email</span></th>
        <th><span>Started</span></th>
        <th><span>Ended</span></th>
        <th><span>Affiliated?</span></th>
        <th><span>Admin?</span></th>
        <th><span>Leader?</span></th>
        </tr>
        <tr *ngFor='let employee of this.userProfiles'>
          <td><span><button *ngIf="this.isUserAdmin" class="col-xs-2 col-sm-2 col-md-2 text-center" (click)="deleteEmployee(employee.proxyId, employee.role)">X</button></span></td>
          <td><span>{{employee.name}}</span></td>
          <td><span>{{employee.username}}</span></td>
          <td><span><input style="width: 100%" (change)="updateEmployee(employee.proxyId,'startDate',employee.startDate)" [(ngModel)]="employee.startDate" onblur="(this.type='text')" onfocus="(this.type='date')"></span></td>
          <td><span><input style="width: 100%" (change)="updateEmployee(employee.proxyId,'endDate',employee.endDate)" [(ngModel)]="employee.endDate" onblur="(this.type='text')" onfocus="(this.type='date')"></span></td>
          <td><span><input type="checkbox" (change)="updateEmployee(employee.proxyId,'stillAffiliated',employee.stillAffiliated)" [(ngModel)]="employee.stillAffiliated" /></span></td>
          <td><span><input *ngIf="this.isUserAdmin && employee.role != this.adminRoleId" class="btn btn-primary" (click)="updateEmployee(employee.proxyId, 'role', this.adminRoleId)" type="button" value="Make Admin"></span></td>
          <td><span><input type="checkbox" (change)="updateEmployee(employee.proxyId,'leader',employee.leader)" [(ngModel)]="employee.leader" /></span></td>
        </tr>
      </table>

      <select *ngIf="this.isUserAdmin" class="form-control" [(ngModel)]="this.newUserSelected">
        <option *ngFor="let user of this.userProfilesAll" value={{user._id}}>{{user.firstName + " " + user.lastName + ": " + user.username }}</option>
      </select>
      <input *ngIf="this.isUserAdmin" type="button" value="Add employee" (click)="addEmployee(this.newUserSelected)"/>
    </div>
  </div>
  <div *ngIf="creatingNew" class="container">
    You will be the first employee and admin for this company when you create it. Once the company is created you can add new employees.
  </div>
</div>

<div class="products col-xs-12 clear" *ngIf='!this.creatingNew'>
  <div class="div-title col-xs-12">
    <img src="./assets/img/product.png">
    <p>PRODUCTS</p>
    <div></div>
  </div>
  <div *ngFor='let product of this.products; let prodIndex = index' class="container mt50 product-container">
    <div class="col-xs-12 srow">
      <div class="col-xs-12 col-md-6 right">
        <div class="col-xs-12 srow info-input">
          <p class="left">More info</p>
          <input class="right" type="text" placeholder="URL to show more info." [(ngModel)]="product.moreInfoLink">
        </div>
      </div>
    </div>
    <div class="col-xs-12">
      <div class="col-xs-12 col-md-6 left">
        <div class="col-xs-12 srow info-input">
          <p class="left">Product name</p>
          <input class="right" type="text" placeholder="Product name." [(ngModel)]='product.name'>
        </div>
      </div>
      <div class="col-xs-12 col-md-6 right">
        <div class="col-xs-12 srow info-input">
          <p class="left">Video demo</p>
          <input class="right" type="text" placeholder="URL to Video demo." [(ngModel)]="product.viewDemoLink">
        </div>
      </div>
    </div>
    <div class="col-xs-12">
      <div class="col-xs-12 col-sm-6">
        <p class="col-xs-12 lh-50">Product Description</p>
        <div class="col-xs-12 text-container" [style.height]="'300px'"><textarea [(ngModel)]='product.description'></textarea></div>
      </div>
      <div class="col-xs-12 col-sm-6">
        <p class="col-xs-12 lh-50">Agencies using it today</p>
        <div class="col-xs-12 text-container" [style.overflow] = "'auto'" [style.height]="'300px'">
          <div class="col-xs-12" *ngFor='let customer of '><input type="checkbox" class="left"><p >XXX</p></div>
          <div class="col-xs-12"><input type="checkbox" class="left"><p >XXX</p></div>
          <div class="col-xs-12"><input type="checkbox" class="left"><p >XXX</p></div>
          <div class="col-xs-12"><input type="checkbox" class="left"><p >XXX</p></div>
          <div class="col-xs-12"><input type="checkbox" class="left"><p >XXX</p></div>
          <div class="col-xs-12"><input type="checkbox" class="left"><p >XXX</p></div>
          <div class="col-xs-12"><input type="checkbox" class="left"><p >XXX</p></div>
          <div class="col-xs-12"><input type="checkbox" class="left"><p >XXX</p></div>
          <div class="col-xs-12"><input type="checkbox" class="left"><p >XXX</p></div>
        </div>
      </div>
    </div>
    <div class="col-xs-12 mt30">
      <div class="col-xs-12 col-md-4 srow">
        <p class="left">Will you customize the product?</p>
        <button class="right mt5" [class.btn-primary] = 'product.customization' (click)='product.customization = !product.customization'>
          {{product.customization?'YES':'NO'}}
        </button>
      </div>
      <div class="col-xs-12 col-md-4 srow">
        <p class="left">Do you provide training?</p>
        <button class="right mt5" [class.btn-primary] = 'product.training' (click)='product.training = !product.training'>
          {{product.training?'YES':'NO'}}
        </button>
      </div>
      <div class="col-xs-12 col-md-4 srow">
        <p class="left">Do you provide maintenance?</p>
        <button class="right mt5" [class.btn-primary] = 'product.maintenance' (click)='product.maintenance = !product.maintenance'>
          {{product.maintenance?'YES':'NO'}}
        </button>
      </div>
    </div>
    <div class="col-xs-12 fs-20 mt20">Defense</div>
    <div class="col-xs-12" *ngFor='let customer of product.customers.defense; let i = index'>
      <div class="col-xs-12 col-md-5 srow info-input">
        <p class="left">Name</p>
        <input class="right" [(ngModel)]='customer.name'>
      </div>
      <div class="col-xs-12 col-md-5 srow info-input">
        <p class="left">Avatar</p>
        <input class="right" [(ngModel)]='customer.avatar'>
      </div>
      <button class="col-xs-offset-5 col-md-2 col-md-offset-0" (click)="deleteDefense(product, i)">REMOVE</button>
    </div>
    <div class="col-xs-12 text-center   mt20   mb20">
      <button class="mr10" (click)="addDefense(product)">ADD</button>
    </div>
    <div class="col-xs-12 fs-20">Civilian</div>
    <div class="col-xs-12" *ngFor='let customer of product.customers.civilian; let i = index'>
      <div class="col-xs-12 col-md-5 srow info-input">
        <p class="left">Name</p>
        <input class="right" [(ngModel)]='customer.name'>
      </div>
      <div class="col-xs-12 col-md-5 srow info-input">
        <p class="left">Avatar</p>
        <input class="right" [(ngModel)]='customer.avatar'>
      </div>
      <button class="col-xs-offset-5 col-md-2 col-md-offset-0" (click)="deleteCivilian(product, i)">REMOVE</button>
    </div>
    <div class="col-xs-12 text-center   mt20   mb20">
      <button class="mr10" (click)="addCivilian(product)">ADD</button>
    </div>
    <div class="col-xs-12 fs-20">Commercial</div>
    <div class="col-xs-12" *ngFor='let customer of product.customers.commercial; let i = index'>
      <div class="col-xs-12 col-md-5 srow info-input">
        <p class="left">Name</p>
        <input class="right" [(ngModel)]='customer.name'>
      </div>
      <div class="col-xs-12 col-md-5 srow info-input">
        <p class="left">Avatar</p>
        <input class="right" [(ngModel)]='customer.avatar'>
      </div>
      <button class="col-xs-offset-5 col-md-2 col-md-offset-0" (click)="deleteCommercial(product, i)">REMOVE</button>
    </div>
    <div class="col-xs-12 text-center   mt20   mb20">
      <button class="mr10" (click)="addCommercial(product)">ADD</button>
    </div>
    <div class='col-xs-12'>
      <button class='col-xs-4 col-xs-offset-4' type="button" name="button" (click)='deleteProduct(prodIndex)'>Delete This Product</button>
    </div>
  </div>
  <div class='col-xs-12'>
    <button class='col-xs-4 col-xs-offset-4' type="button" name="button" (click)='addProduct()'>Add Product</button>
  </div>
</div>

<div class="services col-xs-12 clear" *ngIf='!this.creatingNew'>
  <div class="div-title col-xs-12">
    <img src="./assets/img/profile/capabilities-1.png">
    <p>SERVICES</p>
    <div></div>
  </div>
  <div class="container">
    <div class="col-xs-12" *ngFor='let service of this.services; let servIndex = index'>
      <input class="col-xs-6 fs-25 mt20 mb20" [(ngModel)]='service.name'>
      <div class="col-xs-13" *ngFor='let feature of service.feature; let i = index'>
        <div class="col-xs-11">
          <div class="col-xs-12 col-sm-6 srow info-input">
            <p class="left">Title</p>
            <input class="right" [(ngModel)]='feature.title'>
          </div>
          <div class="col-xs-12 col-sm-6 srow info-input">
            <p class="left">Score</p>
            <input class="right" [(ngModel)]='feature.score'>
          </div>
        </div>
        <button class="col-xs-offset-5 col-sm-1 col-sm-offset-0" (click)="deleteFeature(service, i)">DEL</button>
      </div>
      <div class="col-xs-12 text-center   mt20   mb20">
        <button class="mr10" (click)="addFeature(service)">ADD</button>
      </div>
      <div class="col-xs-12 col-sm-6 srow info-input" *ngFor='let skill of service.skills; let i = index; trackBy:customTrackBy'>
        <p class="left">Skill</p>
        <input class="right" [(ngModel)]='service.skills[i]'>
        <button class="tiny-button-skills" (click)="deleteSkill(service, i)"><div class="tiny-button-text">x</div></button>
      </div>
      <div class="col-xs-12 text-center   mt20   mb20">
        <button class="mr10" (click)="addSkill(service)">ADD</button>
      </div>
      <div class='col-xs-12'>
        <button class='col-xs-4 col-xs-offset-4' type="button" name="button" (click)='deleteService(servIndex)'>Delete This Service</button>
      </div>
    </div>
    <div class='col-xs-12'>
      <button class='col-xs-4 col-xs-offset-4' type="button" name="button" (click)='addService()'>Add Service</button>
    </div>
  </div>

  <!-- <div class="certification col-xs-12">
    <div class="div-title col-xs-12">
      <img src="./assets/img/profile/certificate.png">
      <p>CERTIFICATES</p>
      <div ></div>
    </div>
    <div class="col-xs-11 col-xs-offset-1">
        <p class="col-xs-4 text-left">Name</p>
        <p class="col-xs-4 text-left">Date Earned</p>
    </div>

    <div class="col-xs-11 col-xs-offset-1" type="text" *ngFor="let certificate of this.currentUser.certification; let i = index">
      <div class="col-xs-4">
        <input class="col-xs-11" type="text" [(ngModel)] = 'certificate.CertificationName'>
      </div>
      <div class="col-xs-4">
        <input class="col-xs-11" type="text" [(ngModel)] = 'certificate.DateEarned'>
      </div>
        <div class="col-xs-3 col-xs-offset-1" style="padding-top: 1%; height: 100%; margin-top: 20px">
          <button class="col-xs-12 side-button" style="height: 12%; margin-top: -24px" (click)="deleteCertificate(i)">DELETE</button>
        </div>
      </div>
    <button class="col-xs-6 col-xs-offset-3 col-md-4 col-md-offset-4" (click)="addCertificate()">Add Certificate</button>
  </div>

  <div class="certification col-xs-12">
    <div class="div-title col-xs-12">
      <img src="./assets/img/profile/clearances.png">
      <p>CLEARANCES</p>
      <div ></div>
    </div>
    <div class="col-xs-12 text-center" *ngFor="let index of this.currentUser.clearance; let i = index">
      <div class="col-xs-10" style="padding-top: 2%">
        <div class="col-xs-4">
          <p class="col-xs-12 text-left">Type: </p>
          <input class="col-xs-12" [(ngModel)] = 'index.clearanceType'>
        </div>
        <div class="col-xs-4 text-left">
          <p class="col-xs-12">Awarded: </p>
          <input class="col-xs-12" [(ngModel)] = 'index.awarded'>
        </div>
        <div class="col-xs-4 text-left">
          <p class="col-xs-12">Expiration: </p>
          <input class="col-xs-12" [(ngModel)] = 'index.expiration'>
        </div>
      </div>
      <div class="col-xs-2" style="padding-top: 4%">
        <button class="col-xs-12" style="height: 12%; margin: 1%;" (click)="deleteClearance(i)">DELETE</button>
      </div>
    </div>
    <button class="col-xs-6 col-xs-offset-3 col-md-4 col-md-offset-4" (click)="addClearance()">Add Clearance</button>
  </div> -->

  <!-- <div class="certification col-xs-12">
    <div class="div-title col-xs-12">
      <img src="./assets/img/profile/awards.png">
      <p>AWARDS</p>
      <div ></div>
    </div>
    <div class="col-xs-12 text-center">
      <div class="col-xs-12" style="padding-top: 2%">
        <div class="col-xs-6 text-left" *ngFor="let award of this.currentUser.award; let i = index; trackBy:customTrackBy">
          <input class="col-xs-12" [(ngModel)] = 'this.currentUser.award[i]'>
          <button class="tiny-button-awards" (click)="deleteAward(i)"><div class="tiny-button-text">x</div></button>
        </div>
      </div>
    </div>
    <button class="col-xs-6 col-xs-offset-3 col-md-4 col-md-offset-4" (click)="addAward()" style="margin-top: 5px">Add Award</button>
  </div> -->

  <div class="vehicle col-xs-12 clear">
    <div class="div-title col-xs-12">
        <img src="./assets/img/vehicle.png">
        <p>VEHICLES</p>
        <div></div>
    </div>
    <div class="container">
      <div class="col-xs-13" *ngFor='let vehicle of this.currentAccount.vehicles; let i = index'>
        <div class="col-xs-11">
          <div class="col-xs-12 col-sm-6 srow info-input">
            <p class="left">Vehicle</p>
            <input class="right" [(ngModel)]='vehicle.vehicleType'>
          </div>
          <div class="col-xs-12 col-sm-6 srow info-input">
            <p class="left">Quantity</p>
            <input class="right" [(ngModel)]='vehicle.quantity'>
          </div>
        </div>
        <button class="col-xs-offset-5 col-sm-1 col-sm-offset-0" (click)="deleteVehicle(vehicle, i)">DEL</button>
      </div>
      <button class="col-xs-6 col-xs-offset-3 col-md-4 col-md-offset-4" (click)="addVehicle()" style="margin-top: 5px">Add Vehicle</button>
    </div>
  </div>


</div>
